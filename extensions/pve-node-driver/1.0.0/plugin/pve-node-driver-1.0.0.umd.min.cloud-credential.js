(("undefined"!==typeof self?self:this)["webpackChunkpve_node_driver_1_0_0"]=("undefined"!==typeof self?self:this)["webpackChunkpve_node_driver_1_0_0"]||[]).push([[916],{3379:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return G}});var a=r(9274);const o={key:0,class:"mb-20"},n={class:"mb-20"},l={class:"mb-20"},i={class:"mb-20"};function c(e,t,r,c,d,s){const u=(0,a.resolveComponent)("Banner"),p=(0,a.resolveComponent)("LabeledInput"),b=(0,a.resolveComponent)("Checkbox");return(0,a.openBlock)(),(0,a.createElementBlock)("div",null,[e.errorLabelKey?((0,a.openBlock)(),(0,a.createElementBlock)("div",o,[(0,a.createVNode)(u,{color:"error","label-key":e.errorLabelKey},null,8,["label-key"])])):(0,a.createCommentVNode)("",!0),(0,a.createElementVNode)("div",n,[(0,a.createVNode)(p,{type:"text",mode:r.mode,value:r.value.decodedData.url,onChange:t[0]||(t[0]=e=>{r.value.setData("url",e.target.value),s.validate()}),"label-key":"cluster.credential.pve.url.label","placeholder-key":"cluster.credential.pve.url.placeholder",required:""},null,8,["mode","value"])]),(0,a.createElementVNode)("div",l,[(0,a.createVNode)(b,{mode:r.mode,value:r.value.decodedData.insecureTls,onClick:t[1]||(t[1]=e=>{r.value.setData("insecureTls",!r.value.decodedData.insecureTls),s.validate()}),"label-key":"cluster.credential.pve.insecureTLS.label"},null,8,["mode","value"]),r.value.decodedData.insecureTls?((0,a.openBlock)(),(0,a.createBlock)(u,{key:0,color:"warning","label-key":"cluster.credential.pve.insecureTLS.warning"})):(0,a.createCommentVNode)("",!0)]),(0,a.createElementVNode)("div",i,[(0,a.createVNode)(p,{type:"text",mode:r.mode,value:r.value.decodedData.tokenId,onChange:t[2]||(t[2]=e=>{r.value.setData("tokenId",e.target.value),s.validate()}),"label-key":"cluster.credential.pve.tokenID.label","placeholder-key":"cluster.credential.pve.tokenID.placeholder","tooltip-key":"cluster.credential.pve.tokenID.tooltip",required:""},null,8,["mode","value"])]),(0,a.createElementVNode)("div",null,[(0,a.createVNode)(p,{type:"password",mode:r.mode,value:r.value.decodedData.tokenSecret,onChange:t[3]||(t[3]=e=>{r.value.setData("tokenSecret",e.target.value),s.validate()}),"label-key":"cluster.credential.pve.tokenSecret.label","placeholder-key":"cluster.credential.pve.tokenSecret.placeholder",required:""},null,8,["mode","value"])])])}const d={key:0,class:"banner__icon","data-testid":"banner-icon"},s={key:1},u={key:2},p=["aria-label"];function b(e,t,r,o,n,l){const i=(0,a.resolveComponent)("t"),c=(0,a.resolveDirective)("clean-html");return(0,a.openBlock)(),(0,a.createElementBlock)("div",{class:(0,a.normalizeClass)(["banner",{[e.color]:!0}]),role:"banner"},[e.icon?((0,a.openBlock)(),(0,a.createElementBlock)("div",d,[(0,a.createElementVNode)("i",{class:(0,a.normalizeClass)(["icon icon-2x",e.icon])},null,2)])):(0,a.createCommentVNode)("",!0),(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["banner__content",{closable:e.closable,stacked:e.stacked,icon:e.icon}]),"data-testid":"banner-content"},[(0,a.renderSlot)(e.$slots,"default",{},(()=>[e.labelKey?((0,a.openBlock)(),(0,a.createBlock)(i,{key:0,k:e.labelKey,raw:!0},null,8,["k"])):e.messageLabel?((0,a.openBlock)(),(0,a.createElementBlock)("span",s,(0,a.toDisplayString)(e.messageLabel),1)):(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)("span",u,null,512)),[[c,e.nlToBr(e.label)]])]),!0),e.closable?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:0,class:"banner__content__closer",tabindex:"0",role:"button","aria-label":e.t("generic.close"),onClick:t[0]||(t[0]=t=>e.$emit("close")),onKeyup:[t[1]||(t[1]=(0,a.withKeys)((t=>e.$emit("close")),["enter"])),t[2]||(t[2]=(0,a.withKeys)((t=>e.$emit("close")),["space"]))]},t[3]||(t[3]=[(0,a.createElementVNode)("i",{"data-testid":"banner-close",class:"icon icon-close closer-icon"},null,-1)]),40,p)):(0,a.createCommentVNode)("",!0)],2)],2)}var h=r(2043),v=r(8851);function k(e,t,r){return(t=y(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y(e){var t=m(e,"string");return"symbol"==typeof t?t:t+""}function m(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}class f extends Error{constructor(e){super(e),this.name=f.NAME}}k(f,"NAME","ClusterNotFoundError");class x extends Error{constructor(e,t){super(e),this.url=t,this.name=x.NAME}}k(x,"NAME","RedirectToError");Error;function g(e){let t;if("string"===typeof e)t=e;else if(e&&"object"===typeof e)if(e.message){if(t=e.message,"string"===typeof t)try{const e=JSON.parse(t).data;if(e)return e}catch{}e.detail&&(t?t+=` (${e.detail})`:t=e.detail)}else e.detail?t=e.detail:e.url&&(t=`from ${e.url}`);return t||(t=JSON.stringify(e)),t}var _=(0,a.defineComponent)({props:{color:{type:String,default:"secondary"},label:{type:[String,Error,Object],default:null},labelKey:{type:String,default:null},icon:{type:String,default:null},closable:{type:Boolean,default:!1},stacked:{type:Boolean,default:!1}},emits:["close"],computed:{messageLabel(){return"string"!==typeof this.label?g(this.label):void 0}},methods:{nlToBr:h.Kn}}),w=(r(7394),r(7433));const B=(0,w.A)(_,[["render",b],["__scopeId","data-v-1a4e45d4"]]);var D=B;const K=["id","checked","value"],C=["tabindex","aria-label","aria-checked","aria-labelledby","aria-describedby"],E=["id"],S=["tabindex"],N=["tabindex"],V={key:0,class:"checkbox-outer-container-description"},T=["id"],L={class:"checkbox-outer-container-extra"};function $(e,t,r,o,n,l){const i=(0,a.resolveComponent)("t"),c=(0,a.resolveDirective)("clean-tooltip"),d=(0,a.resolveDirective)("stripped-aria-label");return(0,a.openBlock)(),(0,a.createElementBlock)("div",{class:(0,a.normalizeClass)(["checkbox-outer-container",{"v-popper--has-tooltip":e.hasTooltip}]),"data-checkbox-ctrl":""},[(0,a.createElementVNode)("label",{class:(0,a.normalizeClass)(["checkbox-container",{disabled:e.isDisabled}]),onKeydown:[t[2]||(t[2]=(0,a.withKeys)((0,a.withModifiers)((t=>e.clicked(t)),["prevent"]),["enter"])),t[3]||(t[3]=(0,a.withKeys)((0,a.withModifiers)((t=>e.clicked(t)),["prevent"]),["space"]))],onClick:t[4]||(t[4]=t=>e.clicked(t))},[(0,a.createElementVNode)("input",{id:e.id,checked:e.isChecked,value:e.valueWhenTrue,type:"checkbox",tabindex:"-1",onClick:t[0]||(t[0]=(0,a.withModifiers)((()=>{}),["stop","prevent"])),onKeyup:t[1]||(t[1]=(0,a.withKeys)((0,a.withModifiers)((()=>{}),["stop","prevent"]),["enter"]))},null,40,K),(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)(["checkbox-custom",{indeterminate:e.indeterminate}]),tabindex:e.isDisabled?-1:0,"aria-label":e.replacementLabel,"aria-checked":!!e.value,"aria-labelledby":e.labelKey||e.label?e.idForLabel:void 0,"aria-describedby":e.descriptionKey||e.description?e.describedById:void 0,role:"checkbox"},null,10,C),e.$slots.label||e.label||e.labelKey||e.hasTooltip?((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:0,class:(0,a.normalizeClass)(["checkbox-label",{"checkbox-primary":e.primary}])},[(0,a.renderSlot)(e.$slots,"label",{},(()=>[e.labelKey?((0,a.openBlock)(),(0,a.createBlock)(i,{key:0,id:e.idForLabel,k:e.labelKey,raw:!0},null,8,["id","k"])):e.label?((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:1,id:e.idForLabel},(0,a.toDisplayString)(e.label),9,E)):(0,a.createCommentVNode)("",!0),e.tooltipKey?(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)("i",{key:2,class:"checkbox-info icon icon-info icon-lg",tabindex:e.isDisabled?-1:0},null,8,S)),[[c,{content:e.t(e.tooltipKey),triggers:["hover","touch","focus"]}],[d,e.t(e.tooltipKey)]]):e.tooltip?(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)("i",{key:3,class:"checkbox-info icon icon-info icon-lg",tabindex:e.isDisabled?-1:0},null,8,N)),[[c,{content:e.tooltip,triggers:["hover","touch","focus"]}],[d,e.tooltip]]):(0,a.createCommentVNode)("",!0)]))],2)):(0,a.createCommentVNode)("",!0)],34),e.descriptionKey||e.description?((0,a.openBlock)(),(0,a.createElementBlock)("div",V,[e.descriptionKey?((0,a.openBlock)(),(0,a.createBlock)(i,{key:0,id:e.describedById,k:e.descriptionKey},null,8,["id","k"])):e.description?((0,a.openBlock)(),(0,a.createElementBlock)("p",{key:1,id:e.describedById},(0,a.toDisplayString)(e.description),9,T)):(0,a.createCommentVNode)("",!0)])):(0,a.createCommentVNode)("",!0),(0,a.createElementVNode)("div",L,[(0,a.renderSlot)(e.$slots,"extra")])],2)}var I=r(4220),M=r(6108),A=r.n(M),q=(0,a.defineComponent)({name:"Checkbox",props:{value:{type:[Boolean,Array,String],default:!1},label:{type:String,default:null},labelKey:{type:String,default:null},id:{type:String,default:(0,h.aR)(12)},disabled:{type:Boolean,default:!1},indeterminate:{type:Boolean,default:!1},mode:{type:String,default:I.G5},tooltip:{type:[String,Object],default:null},tooltipKey:{type:String,default:null},valueWhenTrue:{type:[Boolean,String,Number],default:!0},descriptionKey:{type:String,default:null},description:{type:String,default:null},primary:{type:Boolean,default:!1},alternateLabel:{type:String,default:void 0}},emits:["update:value"],data(){return{describedById:`described-by-${(0,h.aR)(12)}`}},computed:{isDisabled(){return this.disabled||this.mode===I.nW},isChecked(){return this.isMulti(this.value)?this.findTrueValues(this.value):this.value===this.valueWhenTrue},hasTooltip(){return!!this.tooltip||!!this.tooltipKey},replacementLabel(){if(!this.label&&!this.labelKey&&this.alternateLabel)return this.alternateLabel},idForLabel(){return`${this.id}-label`}},methods:{clicked(e){if("A"===e.target.tagName&&e.target.href)return!0;if(e.stopPropagation(),e.preventDefault(),this.isDisabled)return;const t={bubbles:!0,cancelable:!1,shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey},r=new CustomEvent("click",t),a=A()(this.value);this.isMulti(a)?(this.isChecked?(0,v.Gj)(a,this.valueWhenTrue):(0,v.PG)(a,this.valueWhenTrue),this.$emit("update:value",a)):this.isString(this.valueWhenTrue)?this.isChecked?this.$emit("update:value",null):this.$emit("update:value",this.valueWhenTrue):(this.$emit("update:value",!a),this.$el.dispatchEvent(r))},isMulti(e){return Array.isArray(e)},isString(e){return"string"===typeof e},findTrueValues(e){return e.find((e=>e===this.valueWhenTrue))||!1}}});r(7192);const z=(0,w.A)(q,[["render",$]]);var P=z,j=r(4415);function W(e){const t=W.options,r=t.parser[t.strictMode?"strict":"loose"].exec(e);if(!r)throw new Error(`Cannot parse as uri: ${e}`);const a={};let o=14;while(o--)a[t.key[o]]=r[o]||"";return a.query={},a.queryStr.replace(t.q.parser,((e,r,o)=>(r&&(a[t.q.name][r]=o),""))),a}W.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","queryStr","anchor"],q:{name:"query",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var O={components:{Banner:D,Checkbox:P,LabeledInput:j.o},props:{mode:{type:String,required:!0},value:{type:Object,required:!0}},data:()=>({errorLabelKey:null}),created(){this.value.setData("url",this.value.decodedData.url??""),this.value.setData("insecureTls",this.value.decodedData.insecureTls??!1),this.value.setData("tokenId",this.value.decodedData.tokenId??""),this.value.setData("tokenSecret",this.value.decodedData.tokenSecret??""),this.validate()},methods:{validate(){""!=this.value.decodedData.url&&""!=this.value.decodedData.tokenId&&""!=this.value.decodedData.tokenSecret?this.$emit("validationChanged",!0):this.$emit("validationChanged",!1)},async test(){this.errorLabelKey=null;try{const e=await this.$store.dispatch("rancher/find",{type:"nodedriver",id:"pve"}),t=W(this.value.decodedData.url).host,r=e.whitelistDomains??[];if(!r.includes(t))return this.errorLabelKey="cluster.credential.pve.errors.whitelistedDomains",!1}catch(e){return this.errorLabelKey="cluster.credential.pve.errors.fetchNodeDriver",!1}if(!this.value.decodedData.insecureTls)try{const{data:e}=await this.$store.dispatch("management/request",{method:"GET",url:"/meta/proxy/"+this.value.decodedData.url.replace(/^https?:\/\//,"")+"/api2/json/version",headers:{"X-API-Auth-Header":`PVEAPIToken=${this.value.decodedData.tokenId}=${this.value.decodedData.tokenSecret}`},redirectUnauthorized:!1});if(!e.version.startsWith("8."))return this.errorLabelKey="cluster.credential.pve.errors.unsupportedProxmoxVersion",!1}catch(e){return 401==e._status?this.errorLabelKey="cluster.credential.pve.errors.fetchProxmoxVersionUnauthorized":this.errorLabelKey="cluster.credential.pve.errors.fetchProxmoxVersion",!1}return!0}}};const F=(0,w.A)(O,[["render",c]]);var G=F},6117:function(e,t,r){"use strict";r.r(t);var a=r(6758),o=r.n(a),n=r(6173),l=r.n(n),i=l()(o());i.push([e.id,".banner[data-v-1a4e45d4]{display:flex;margin:15px 0;position:relative;width:100%;color:var(--body-text)}.banner__icon[data-v-1a4e45d4]{width:48px;flex-grow:1;display:flex;justify-content:center;align-items:center;box-sizing:content-box}.primary .banner__icon[data-v-1a4e45d4]{background:var(--primary)}.secondary .banner__icon[data-v-1a4e45d4]{background:var(--default)}.success .banner__icon[data-v-1a4e45d4]{background:var(--success)}.info .banner__icon[data-v-1a4e45d4]{background:var(--info)}.warning .banner__icon[data-v-1a4e45d4]{background:var(--warning)}.error .banner__icon[data-v-1a4e45d4]{background:var(--error);color:var(--primary-text)}.banner__content[data-v-1a4e45d4]{padding:10px;transition:all .2s ease;line-height:20px;width:100%;border-left:4px solid transparent;display:flex;gap:3px}.primary .banner__content[data-v-1a4e45d4]{background:var(--primary);border-color:var(--primary)}.secondary .banner__content[data-v-1a4e45d4]{background:var(--default-banner-bg);border-color:var(--default)}.success .banner__content[data-v-1a4e45d4]{background:var(--success-banner-bg);border-color:var(--success)}.info .banner__content[data-v-1a4e45d4]{background:var(--info-banner-bg);border-color:var(--info)}.warning .banner__content[data-v-1a4e45d4]{background:var(--warning-banner-bg);border-color:var(--warning)}.error .banner__content[data-v-1a4e45d4]{background:var(--error-banner-bg);border-color:var(--error);color:var(--error)}.banner__content.stacked[data-v-1a4e45d4]{padding:0 10px;margin:0;transition:none}.banner__content.stacked[data-v-1a4e45d4]:first-child{padding-top:10px}.banner__content.stacked[data-v-1a4e45d4]:last-child{padding-bottom:10px}.banner__content.closable[data-v-1a4e45d4]{padding-right:48px}.banner__content__closer[data-v-1a4e45d4]{display:flex;align-items:center;cursor:pointer;position:absolute;top:0;right:0;bottom:0;width:24px;line-height:24px;text-align:center;outline:none}.banner__content__closer .closer-icon[data-v-1a4e45d4]{opacity:.7}.banner__content__closer .closer-icon[data-v-1a4e45d4]:hover{opacity:1;color:var(--link)}.banner__content__closer:focus-visible i[data-v-1a4e45d4]{outline:2px solid var(--primary-keyboard-focus);outline-offset:2px}.banner__content.icon[data-v-1a4e45d4]{border-left:none}",""]),t["default"]=i},7192:function(e,t,r){var a=r(9883);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);var o=r(4825).A;o("0060fc85",a,!0,{sourceMap:!1,shadowMode:!1})},7394:function(e,t,r){var a=r(6117);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);var o=r(4825).A;o("d4f9953a",a,!0,{sourceMap:!1,shadowMode:!1})},9883:function(e,t,r){"use strict";r.r(t);var a=r(6758),o=r.n(a),n=r(6173),l=r.n(n),i=l()(o());i.push([e.id,'.checkbox-outer-container{display:inline-flex;flex-direction:column}.checkbox-outer-container-description{color:var(--input-label);opacity:.8}.checkbox-outer-container-description,.checkbox-outer-container-extra{font-size:14px;margin-left:19px;margin-top:5px}.checkbox-container{position:relative;display:inline-flex;align-items:center;margin:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;user-select:none;border-radius:var(--border-radius)}.checkbox-container .checkbox-label{color:var(--input-label);display:inline-flex;margin:0 10px 0 5px}.checkbox-container .checkbox-label.checkbox-primary{color:inherit;font-weight:600}.checkbox-container .checkbox-info{line-height:normal;margin-left:2px}.checkbox-container .checkbox-info:focus-visible{outline:2px solid var(--primary-keyboard-focus);outline-offset:2px}.checkbox-container .checkbox-custom{height:14px;width:14px;background-color:var(--body-bg);border-radius:var(--border-radius);border:1px solid var(--border);flex-shrink:0}.checkbox-container .checkbox-custom:focus-visible{outline:2px solid var(--primary-keyboard-focus);outline-offset:2px;border-radius:0}.checkbox-container input{opacity:0;position:absolute;z-index:-1}.checkbox-container input:focus-visible~.checkbox-custom{outline:2px solid var(--primary-keyboard-focus);outline-offset:2px;border-radius:0}.checkbox-container input:checked~.checkbox-custom{background-color:var(--primary);transform:rotate(0deg) scale(1);opacity:1;border:1px solid var(--primary)}.checkbox-container .checkbox-custom:after{position:absolute;content:"";left:0;top:0;height:0;width:0;border-radius:var(--border-radius);border:solid;border-color:var(--input-text);border-width:0 3px 3px 0;transform:rotate(0deg) scale(0);opacity:1}.checkbox-container input:checked~.checkbox-custom:after{transform:rotate(45deg) scale(1);opacity:1;left:4px;width:4px;height:10px;border:solid;border-color:var(--checkbox-tick);border-width:0 2px 2px 0;background-color:transparent}.checkbox-container input:checked~.checkbox-custom.indeterminate:after{transform:scale(1);opacity:1;left:3px;top:2px;width:6px;height:5px;border:solid;border-color:var(--checkbox-tick);border-width:0 0 2px 0;background-color:transparent}.checkbox-container.disabled .checkbox-custom,.checkbox-container.disabled input:checked~.checkbox-custom{background-color:var(--checkbox-disabled-bg);border-color:var(--checkbox-disabled-bg)}.checkbox-container.disabled input:checked~.checkbox-custom:after{border-color:var(--checkbox-tick-disabled)}.checkbox-container.disabled{cursor:not-allowed}.checkbox-container .checkbox-view{display:flex;flex-direction:column}.checkbox-container .checkbox-view LABEL{color:var(--input-label)}',""]),t["default"]=i}}]);
//# sourceMappingURL=pve-node-driver-1.0.0.umd.min.cloud-credential.js.map