(("undefined"!==typeof self?self:this)["webpackChunkpve_node_driver_1_1_0_rc2"]=("undefined"!==typeof self?self:this)["webpackChunkpve_node_driver_1_1_0_rc2"]||[]).push([[916],{1250:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return V}});var r=a(9274);const n={key:0,class:"mb-20"},o={class:"mb-20"},l={class:"mb-20"},c={class:"mb-20"};function d(e,t,a,d,i,s){const u=(0,r.resolveComponent)("Banner"),v=(0,r.resolveComponent)("LabeledInput"),p=(0,r.resolveComponent)("Checkbox");return(0,r.openBlock)(),(0,r.createElementBlock)("div",null,[e.errorLabelKey?((0,r.openBlock)(),(0,r.createElementBlock)("div",n,[(0,r.createVNode)(u,{color:"error","label-key":e.errorLabelKey},null,8,["label-key"])])):(0,r.createCommentVNode)("",!0),(0,r.createElementVNode)("div",o,[(0,r.createVNode)(v,{type:"text",mode:a.mode,value:a.value.decodedData.url,onChange:t[0]||(t[0]=e=>{a.value.setData("url",e.target.value),s.validate()}),"label-key":"cluster.credential.pve.url.label","placeholder-key":"cluster.credential.pve.url.placeholder",required:""},null,8,["mode","value"])]),(0,r.createElementVNode)("div",l,[(0,r.createVNode)(p,{mode:a.mode,value:a.value.decodedData.insecureTls,onClick:t[1]||(t[1]=e=>{a.value.setData("insecureTls",!a.value.decodedData.insecureTls),s.validate()}),"label-key":"cluster.credential.pve.insecureTLS.label"},null,8,["mode","value"]),a.value.decodedData.insecureTls?((0,r.openBlock)(),(0,r.createBlock)(u,{key:0,color:"warning","label-key":"cluster.credential.pve.insecureTLS.warning"})):(0,r.createCommentVNode)("",!0)]),(0,r.createElementVNode)("div",c,[(0,r.createVNode)(v,{type:"text",mode:a.mode,value:a.value.decodedData.tokenId,onChange:t[2]||(t[2]=e=>{a.value.setData("tokenId",e.target.value),s.validate()}),"label-key":"cluster.credential.pve.tokenID.label","placeholder-key":"cluster.credential.pve.tokenID.placeholder","tooltip-key":"cluster.credential.pve.tokenID.tooltip",required:""},null,8,["mode","value"])]),(0,r.createElementVNode)("div",null,[(0,r.createVNode)(v,{type:"password",mode:a.mode,value:a.value.decodedData.tokenSecret,onChange:t[3]||(t[3]=e=>{a.value.setData("tokenSecret",e.target.value),s.validate()}),"label-key":"cluster.credential.pve.tokenSecret.label","placeholder-key":"cluster.credential.pve.tokenSecret.placeholder",required:""},null,8,["mode","value"])])])}const i={key:0,class:"banner__icon","data-testid":"banner-icon"},s={key:1},u={key:2},v=["aria-label"];function p(e,t,a,n,o,l){const c=(0,r.resolveComponent)("t"),d=(0,r.resolveDirective)("clean-html");return(0,r.openBlock)(),(0,r.createElementBlock)("div",{class:(0,r.normalizeClass)(["banner",{[e.color]:!0}]),role:"banner"},[e.icon?((0,r.openBlock)(),(0,r.createElementBlock)("div",i,[(0,r.createElementVNode)("i",{class:(0,r.normalizeClass)(["icon icon-2x",e.icon])},null,2)])):(0,r.createCommentVNode)("",!0),(0,r.createElementVNode)("div",{class:(0,r.normalizeClass)(["banner__content",{closable:e.closable,stacked:e.stacked,icon:e.icon}]),"data-testid":"banner-content"},[(0,r.renderSlot)(e.$slots,"default",{},()=>[e.labelKey?((0,r.openBlock)(),(0,r.createBlock)(c,{key:0,k:e.labelKey,raw:!0},null,8,["k"])):e.messageLabel?((0,r.openBlock)(),(0,r.createElementBlock)("span",s,(0,r.toDisplayString)(e.messageLabel),1)):(0,r.withDirectives)(((0,r.openBlock)(),(0,r.createElementBlock)("span",u,null,512)),[[d,e.nlToBr(e.label)]])],!0),e.closable?((0,r.openBlock)(),(0,r.createElementBlock)("div",{key:0,class:"banner__content__closer",tabindex:"0",role:"button","aria-label":e.t("generic.close"),onClick:t[0]||(t[0]=t=>e.$emit("close")),onKeyup:[t[1]||(t[1]=(0,r.withKeys)(t=>e.$emit("close"),["enter"])),t[2]||(t[2]=(0,r.withKeys)(t=>e.$emit("close"),["space"]))]},t[3]||(t[3]=[(0,r.createElementVNode)("i",{"data-testid":"banner-close",class:"icon icon-close closer-icon"},null,-1)]),40,v)):(0,r.createCommentVNode)("",!0)],2)],2)}var b=a(2043);a(8851);function m(e,t,a){return(t=h(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function h(e){var t=y(e,"string");return"symbol"==typeof t?t:t+""}function y(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}class k extends Error{constructor(e){super(e),this.name=k.NAME}}m(k,"NAME","ClusterNotFoundError");class f extends Error{constructor(e,t){super(e),this.url=t,this.name=f.NAME}}m(f,"NAME","RedirectToError");Error;function _(e){let t;if("string"===typeof e)t=e;else if(e&&"object"===typeof e)if(e.message){if(t=e.message,"string"===typeof t)try{const e=JSON.parse(t).data;if(e)return e}catch{}e.detail&&(t?t+=` (${e.detail})`:t=e.detail)}else e.detail?t=e.detail:e.url&&(t=`from ${e.url}`);return t||(t=JSON.stringify(e)),t}var g=(0,r.defineComponent)({props:{color:{type:String,default:"secondary"},label:{type:[String,Error,Object],default:null},labelKey:{type:String,default:null},icon:{type:String,default:null},closable:{type:Boolean,default:!1},stacked:{type:Boolean,default:!1}},emits:["close"],computed:{messageLabel(){return"string"!==typeof this.label?_(this.label):void 0}},methods:{nlToBr:b.Kn}}),x=(a(7394),a(7433));const D=(0,x.A)(g,[["render",p],["__scopeId","data-v-1a4e45d4"]]);var w=D,E=a(6187),C=a(4415);function N(e){const t=N.options,a=t.parser[t.strictMode?"strict":"loose"].exec(e);if(!a)throw new Error(`Cannot parse as uri: ${e}`);const r={};let n=14;while(n--)r[t.key[n]]=a[n]||"";return r.query={},r.queryStr.replace(t.q.parser,(e,a,n)=>(a&&(r[t.q.name][a]=n),"")),r}N.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","queryStr","anchor"],q:{name:"query",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var B={components:{Banner:w,Checkbox:E.A,LabeledInput:C.o},props:{mode:{type:String,required:!0},value:{type:Object,required:!0}},data:()=>({errorLabelKey:null}),created(){this.value.setData("url",this.value.decodedData.url??""),this.value.setData("insecureTls",this.value.decodedData.insecureTls??!1),this.value.setData("tokenId",this.value.decodedData.tokenId??""),this.value.setData("tokenSecret",this.value.decodedData.tokenSecret??""),this.validate()},methods:{validate(){""!=this.value.decodedData.url&&""!=this.value.decodedData.tokenId&&""!=this.value.decodedData.tokenSecret?this.$emit("validationChanged",!0):this.$emit("validationChanged",!1)},async test(){this.errorLabelKey=null;try{const e=await this.$store.dispatch("rancher/find",{type:"nodedriver",id:"pve"}),t=N(this.value.decodedData.url).host,a=e.whitelistDomains??[];if(!a.includes(t))return this.errorLabelKey="cluster.credential.pve.errors.whitelistedDomains",!1}catch(e){return this.errorLabelKey="cluster.credential.pve.errors.fetchNodeDriver",!1}if(!this.value.decodedData.insecureTls)try{const{data:e}=await this.$store.dispatch("management/request",{method:"GET",url:"/meta/proxy/"+this.value.decodedData.url.replace(/^https?:\/\//,"")+"/api2/json/version",headers:{"X-API-Auth-Header":`PVEAPIToken=${this.value.decodedData.tokenId}=${this.value.decodedData.tokenSecret}`},redirectUnauthorized:!1});if(!e.version.startsWith("8."))return this.errorLabelKey="cluster.credential.pve.errors.unsupportedProxmoxVersion",!1}catch(e){return 401==e._status?this.errorLabelKey="cluster.credential.pve.errors.fetchProxmoxVersionUnauthorized":this.errorLabelKey="cluster.credential.pve.errors.fetchProxmoxVersion",!1}return!0}}};const S=(0,x.A)(B,[["render",d]]);var V=S},6117:function(e,t,a){"use strict";a.r(t);var r=a(6758),n=a.n(r),o=a(6173),l=a.n(o),c=l()(n());c.push([e.id,".banner[data-v-1a4e45d4]{display:flex;margin:15px 0;position:relative;width:100%;color:var(--body-text)}.banner__icon[data-v-1a4e45d4]{width:48px;flex-grow:1;display:flex;justify-content:center;align-items:center;box-sizing:content-box}.primary .banner__icon[data-v-1a4e45d4]{background:var(--primary)}.secondary .banner__icon[data-v-1a4e45d4]{background:var(--default)}.success .banner__icon[data-v-1a4e45d4]{background:var(--success)}.info .banner__icon[data-v-1a4e45d4]{background:var(--info)}.warning .banner__icon[data-v-1a4e45d4]{background:var(--warning)}.error .banner__icon[data-v-1a4e45d4]{background:var(--error);color:var(--primary-text)}.banner__content[data-v-1a4e45d4]{padding:10px;transition:all .2s ease;line-height:20px;width:100%;border-left:4px solid transparent;display:flex;gap:3px}.primary .banner__content[data-v-1a4e45d4]{background:var(--primary);border-color:var(--primary)}.secondary .banner__content[data-v-1a4e45d4]{background:var(--default-banner-bg);border-color:var(--default)}.success .banner__content[data-v-1a4e45d4]{background:var(--success-banner-bg);border-color:var(--success)}.info .banner__content[data-v-1a4e45d4]{background:var(--info-banner-bg);border-color:var(--info)}.warning .banner__content[data-v-1a4e45d4]{background:var(--warning-banner-bg);border-color:var(--warning)}.error .banner__content[data-v-1a4e45d4]{background:var(--error-banner-bg);border-color:var(--error);color:var(--error)}.banner__content.stacked[data-v-1a4e45d4]{padding:0 10px;margin:0;transition:none}.banner__content.stacked[data-v-1a4e45d4]:first-child{padding-top:10px}.banner__content.stacked[data-v-1a4e45d4]:last-child{padding-bottom:10px}.banner__content.closable[data-v-1a4e45d4]{padding-right:48px}.banner__content__closer[data-v-1a4e45d4]{display:flex;align-items:center;cursor:pointer;position:absolute;top:0;right:0;bottom:0;width:24px;line-height:24px;text-align:center;outline:none}.banner__content__closer .closer-icon[data-v-1a4e45d4]{opacity:.7}.banner__content__closer .closer-icon[data-v-1a4e45d4]:hover{opacity:1;color:var(--link)}.banner__content__closer:focus-visible i[data-v-1a4e45d4]{outline:2px solid var(--primary-keyboard-focus);outline-offset:2px}.banner__content.icon[data-v-1a4e45d4]{border-left:none}",""]),t["default"]=c},7394:function(e,t,a){var r=a(6117);r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals);var n=a(4825).A;n("d4f9953a",r,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=pve-node-driver-1.1.0-rc2.umd.min.cloud-credential.js.map