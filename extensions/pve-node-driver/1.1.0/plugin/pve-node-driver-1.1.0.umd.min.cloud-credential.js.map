{"version":3,"file":"pve-node-driver-1.1.0.umd.min.cloud-credential.js","mappings":"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","sources":["webpack://pve-node-driver-1.1.0/./cloud-credential/pve.vue","webpack://pve-node-driver-1.1.0/../../node_modules/@rancher/shell/rancher-components/Banner/Banner.vue?7689","webpack://pve-node-driver-1.1.0/../../node_modules/@rancher/shell/rancher-components/Banner/Banner.vue","webpack://pve-node-driver-1.1.0/../../node_modules/@rancher/shell/utils/error.js","webpack://pve-node-driver-1.1.0/../../node_modules/@rancher/shell/rancher-components/Banner/Banner.vue?e432","webpack://pve-node-driver-1.1.0/../../node_modules/@rancher/shell/utils/url.ts","webpack://pve-node-driver-1.1.0/./cloud-credential/pve.vue?d73a","webpack://pve-node-driver-1.1.0/../../node_modules/@rancher/shell/rancher-components/Banner/Banner.vue?4169","webpack://pve-node-driver-1.1.0/../../node_modules/@rancher/shell/rancher-components/Banner/Banner.vue?6778"],"sourcesContent":["<script>\nimport Banner from '@components/Banner/Banner';\nimport { Checkbox } from '@components/Form/Checkbox';\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport { parse as parseUrl } from '@shell/utils/url';\n\nexport default {\n  components: {\n    Banner,\n    Checkbox,\n    LabeledInput,\n  },\n  props: {\n    mode: {\n      type:     String,\n      required: true,\n    },\n    value: {\n      type:     Object,\n      required: true,\n    },\n  },\n  data: () => ({\n    errorLabelKey: null,\n  }),\n  created() {\n    this.value.setData('url', this.value.decodedData.url ?? '');\n    this.value.setData('insecureTls', this.value.decodedData.insecureTls ?? false);\n    this.value.setData('tokenId', this.value.decodedData.tokenId ?? '');\n    this.value.setData('tokenSecret', this.value.decodedData.tokenSecret ?? '');\n\n    this.validate();\n  },\n  methods: {\n    validate(){\n      if(this.value.decodedData.url == '') {\n        this.$emit('validationChanged', false);\n        return\n      }\n\n      if(this.value.decodedData.tokenId == '') {\n        this.$emit('validationChanged', false);\n        return\n      }\n\n      if(this.value.decodedData.tokenSecret == '') {\n        this.$emit('validationChanged', false);\n        return\n      }\n\n      this.$emit('validationChanged', true);\n    },\n    async test() {\n      this.errorLabelKey = null;\n\n      // Proxmox VE domain must be present in driver's whitelisted domains\n      try {\n        const nodeDriver = await this.$store.dispatch('rancher/find', {\n          type: 'nodedriver',\n          id:   'pve'\n        });\n\n        const domain = parseUrl(this.value.decodedData.url).host;\n        const whitelistedDomains = nodeDriver.whitelistDomains ?? [];\n\n        if(!whitelistedDomains.includes(domain)) {\n          this.errorLabelKey = 'cluster.credential.pve.errors.whitelistedDomains';\n          return false;\n        }\n      } catch(e) {\n        this.errorLabelKey = 'cluster.credential.pve.errors.fetchNodeDriver';\n        return false;\n      }\n\n      // Proxmox VE version must be 8.x\n      if(!this.value.decodedData.insecureTls) {\n        try {\n          const { data } = await this.$store.dispatch('management/request', {\n            method: 'GET',\n            url: '/meta/proxy/' + this.value.decodedData.url.replace(/^https?:\\/\\//, '') + '/api2/json/version',\n            headers: {\n              \"X-API-Auth-Header\": `PVEAPIToken=${this.value.decodedData.tokenId}=${this.value.decodedData.tokenSecret}`,\n            },\n            redirectUnauthorized: false,\n          })\n  \n          if(!data.version.startsWith('8.')) {\n            this.errorLabelKey = 'cluster.credential.pve.errors.unsupportedProxmoxVersion';\n            return false;\n          }\n        } catch(e) {\n          if(e._status == 401) {\n            this.errorLabelKey = 'cluster.credential.pve.errors.fetchProxmoxVersionUnauthorized';\n          } else {\n            this.errorLabelKey = 'cluster.credential.pve.errors.fetchProxmoxVersion';\n          }\n  \n          return false;\n        }\n      }\n\n      return true;\n    }\n  }\n}\n</script>\n\n<template>\n  <div>\n    <div class=\"mb-20\" v-if=\"errorLabelKey\">\n      <Banner\n        color=\"error\"\n        :label-key=\"errorLabelKey\"\n      />\n    </div>\n    <div class=\"mb-20\">\n      <LabeledInput\n        type=\"text\"\n        :mode=\"mode\"\n        :value=\"value.decodedData.url\"\n        @change=\"e => {value.setData('url', e.target.value); validate();}\"\n        label-key=\"cluster.credential.pve.url.label\"\n        placeholder-key=\"cluster.credential.pve.url.placeholder\"\n        required\n      />\n    </div>\n    <div class=\"mb-20\">\n      <Checkbox\n        :mode=\"mode\"\n        :value=\"value.decodedData.insecureTls\"\n        @click=\"e => {value.setData('insecureTls', !value.decodedData.insecureTls); validate();}\"\n        label-key=\"cluster.credential.pve.insecureTLS.label\"\n      />\n      <Banner\n        v-if=\"value.decodedData.insecureTls\"\n        color=\"warning\"\n        label-key=\"cluster.credential.pve.insecureTLS.warning\"\n      />\n    </div>\n    <div class=\"mb-20\">\n      <LabeledInput\n        type=\"text\"\n        :mode=\"mode\"\n        :value=\"value.decodedData.tokenId\"\n        @change=\"e => {value.setData('tokenId', e.target.value); validate();}\"\n        label-key=\"cluster.credential.pve.tokenID.label\"\n        placeholder-key=\"cluster.credential.pve.tokenID.placeholder\"\n        tooltip-key=\"cluster.credential.pve.tokenID.tooltip\"\n        required\n      />\n    </div>\n    <div>\n      <LabeledInput\n        type=\"password\"\n        :mode=\"mode\"\n        :value=\"value.decodedData.tokenSecret\"\n        @change=\"e => {value.setData('tokenSecret', e.target.value); validate();}\"\n        label-key=\"cluster.credential.pve.tokenSecret.label\"\n        placeholder-key=\"cluster.credential.pve.tokenSecret.placeholder\"\n        required\n      />\n    </div>\n  </div>\n</template>\n","import { normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderSlot as _renderSlot, resolveComponent as _resolveComponent, createBlock as _createBlock, toDisplayString as _toDisplayString, resolveDirective as _resolveDirective, withDirectives as _withDirectives, withKeys as _withKeys } from \"vue\"\n\nconst _hoisted_1 = {\n  key: 0,\n  class: \"banner__icon\",\n  \"data-testid\": \"banner-icon\"\n}\nconst _hoisted_2 = { key: 1 }\nconst _hoisted_3 = { key: 2 }\nconst _hoisted_4 = [\"aria-label\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_t = _resolveComponent(\"t\")!\n  const _directive_clean_html = _resolveDirective(\"clean-html\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", {\n    class: _normalizeClass([\"banner\", {\n      [_ctx.color]: true,\n    }]),\n    role: \"banner\"\n  }, [\n    (_ctx.icon)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n          _createElementVNode(\"i\", {\n            class: _normalizeClass([\"icon icon-2x\", _ctx.icon])\n          }, null, 2)\n        ]))\n      : _createCommentVNode(\"\", true),\n    _createElementVNode(\"div\", {\n      class: _normalizeClass([\"banner__content\", {\n        closable: _ctx.closable,\n        stacked: _ctx.stacked,\n        icon: _ctx.icon\n      }]),\n      \"data-testid\": \"banner-content\"\n    }, [\n      _renderSlot(_ctx.$slots, \"default\", {}, () => [\n        (_ctx.labelKey)\n          ? (_openBlock(), _createBlock(_component_t, {\n              key: 0,\n              k: _ctx.labelKey,\n              raw: true\n            }, null, 8, [\"k\"]))\n          : (_ctx.messageLabel)\n            ? (_openBlock(), _createElementBlock(\"span\", _hoisted_2, _toDisplayString(_ctx.messageLabel), 1))\n            : _withDirectives((_openBlock(), _createElementBlock(\"span\", _hoisted_3, null, 512)), [\n                [_directive_clean_html, _ctx.nlToBr(_ctx.label)]\n              ])\n      ], true),\n      (_ctx.closable)\n        ? (_openBlock(), _createElementBlock(\"div\", {\n            key: 0,\n            class: \"banner__content__closer\",\n            tabindex: \"0\",\n            role: \"button\",\n            \"aria-label\": _ctx.t('generic.close'),\n            onClick: _cache[0] || (_cache[0] = ($event: any) => (_ctx.$emit('close'))),\n            onKeyup: [\n              _cache[1] || (_cache[1] = _withKeys(($event: any) => (_ctx.$emit('close')), [\"enter\"])),\n              _cache[2] || (_cache[2] = _withKeys(($event: any) => (_ctx.$emit('close')), [\"space\"]))\n            ]\n          }, _cache[3] || (_cache[3] = [\n            _createElementVNode(\"i\", {\n              \"data-testid\": \"banner-close\",\n              class: \"icon icon-close closer-icon\"\n            }, null, -1)\n          ]), 40, _hoisted_4))\n        : _createCommentVNode(\"\", true)\n    ], 2)\n  ], 2))\n}","<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport { nlToBr } from '@shell/utils/string';\nimport { stringify } from '@shell/utils/error';\n\nexport default defineComponent({\n  props: {\n    /**\n     * A color class that represents the color of the banner.\n     * @values primary, secondary, success, warning, error, info\n     */\n    color: {\n      type:    String,\n      default: 'secondary'\n    },\n    /**\n     * The label to display as the banner's default content.\n     */\n    label: {\n      type:    [String, Error, Object],\n      default: null\n    },\n    /**\n     * The i18n key for the label to display as the banner's default content.\n     */\n    labelKey: {\n      type:    String,\n      default: null\n    },\n    /**\n     * Add icon for the banner\n     */\n    icon: {\n      type:    String,\n      default: null\n    },\n    /**\n     * Toggles the banner's close button.\n     */\n    closable: {\n      type:    Boolean,\n      default: false\n    },\n    /**\n     * Toggles the stacked class for the banner.\n     */\n    stacked: {\n      type:    Boolean,\n      default: false\n    }\n  },\n  emits:    ['close'],\n  computed: {\n    /**\n     * Return message text as label.\n     */\n    messageLabel(): string | void {\n      return !(typeof this.label === 'string') ? stringify(this.label) : undefined;\n    }\n  },\n  methods: { nlToBr }\n});\n</script>\n<template>\n  <div\n    class=\"banner\"\n    :class=\"{\n      [color]: true,\n    }\"\n    role=\"banner\"\n  >\n    <div\n      v-if=\"icon\"\n      class=\"banner__icon\"\n      data-testid=\"banner-icon\"\n    >\n      <i\n        class=\"icon icon-2x\"\n        :class=\"icon\"\n      />\n    </div>\n    <div\n      class=\"banner__content\"\n      data-testid=\"banner-content\"\n      :class=\"{\n        closable,\n        stacked,\n        icon\n      }\"\n    >\n      <slot>\n        <t\n          v-if=\"labelKey\"\n          :k=\"labelKey\"\n          :raw=\"true\"\n        />\n        <span v-else-if=\"messageLabel\">{{ messageLabel }}</span>\n        <span\n          v-else\n          v-clean-html=\"nlToBr(label)\"\n        />\n      </slot>\n      <div\n        v-if=\"closable\"\n        class=\"banner__content__closer\"\n        tabindex=\"0\"\n        role=\"button\"\n        :aria-label=\"t('generic.close')\"\n        @click=\"$emit('close')\"\n        @keyup.enter=\"$emit('close')\"\n        @keyup.space=\"$emit('close')\"\n      >\n        <i\n          data-testid=\"banner-close\"\n          class=\"icon icon-close closer-icon\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n$left-border-size: 4px;\n$icon-size: 24px;\n\n.banner {\n  display: flex;\n  margin: 15px 0;\n  position: relative;\n  width: 100%;\n  color: var(--body-text);\n\n  &__icon {\n    width: $icon-size * 2;\n    flex-grow: 1;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    box-sizing: content-box;\n\n    .primary & {\n      background: var(--primary);\n    }\n\n    .secondary & {\n      background: var(--default);\n    }\n\n    .success & {\n      background: var(--success);\n    }\n\n    .info & {\n      background: var(--info);\n    }\n\n    .warning & {\n      background: var(--warning);\n    }\n\n    .error & {\n      background: var(--error);\n      color: var(--primary-text);\n    }\n  }\n\n  &__content {\n    padding: 10px;\n    transition: all 0.2s ease;\n    line-height: 20px;\n    width: 100%;\n    border-left: solid $left-border-size transparent;\n    display: flex;\n    gap: 3px;\n\n    .primary & {\n      background: var(--primary);\n      border-color: var(--primary);\n    }\n\n    .secondary & {\n      background: var(--default-banner-bg);\n      border-color: var(--default);\n    }\n\n    .success & {\n      background: var(--success-banner-bg);\n      border-color: var(--success);\n    }\n\n    .info & {\n      background: var(--info-banner-bg);\n      border-color: var(--info);\n    }\n\n    .warning & {\n      background: var(--warning-banner-bg);\n      border-color: var(--warning);\n    }\n\n    .error & {\n      background: var(--error-banner-bg);\n      border-color: var(--error);\n      color: var(--error);\n    }\n\n    &.stacked {\n      padding: 0 10px;\n      margin: 0;\n      transition: none;\n      &:first-child {\n        padding-top: 10px;\n      }\n      &:last-child {\n        padding-bottom: 10px;\n      }\n    }\n\n    &.closable {\n      padding-right: $icon-size * 2;\n    }\n\n    &__closer {\n      display: flex;\n      align-items: center;\n\n      cursor: pointer;\n      position: absolute;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      width: $icon-size;\n      line-height: $icon-size;\n      text-align: center;\n      outline: none;\n\n      .closer-icon {\n        opacity: 0.7;\n\n        &:hover {\n          opacity: 1;\n          color: var(--link);\n        }\n      }\n\n      &:focus-visible i {\n        @include focus-outline;\n        outline-offset: 2px;\n      }\n    }\n\n    &.icon {\n      border-left: none;\n    }\n  }\n}\n</style>\n","import { isArray } from '@shell/utils/array';\n\nexport class ClusterNotFoundError extends Error {\n  static NAME = 'ClusterNotFoundError'\n\n  constructor(message) {\n    super(message);\n    this.name = ClusterNotFoundError.NAME;\n  }\n}\n\n/**\n * An error occurred and the user should be redirected to a certain location (where this is handled)\n */\nexport class RedirectToError extends Error {\n  static NAME = 'RedirectToError'\n\n  constructor(message, url) {\n    super(message);\n    this.url = url;\n    this.name = RedirectToError.NAME;\n  }\n}\n\nexport class ApiError extends Error {\n  constructor(res) {\n    super(stringify(res));\n    this.status = res._status || 0;\n    this.statusText = res._statusText;\n    this.headers = res.headers;\n    this.url = res._url;\n  }\n\n  toString() {\n    return `[${ this.status } ${ this.statusText }]: ${ this.message }`;\n  }\n\n  toJSON() {\n    return {\n      type:       'error',\n      status:     this.status,\n      statusText: this.statusText,\n      message:    this.statusMessage,\n      url:        this.url,\n    };\n  }\n}\n\nexport function stringify(err) {\n  let str;\n\n  if ( typeof err === 'string' ) {\n    str = err;\n  } else if ( err && typeof err === 'object' ) {\n    if ( err.message ) {\n      str = err.message;\n\n      if (typeof str === 'string') {\n        try {\n          const data = JSON.parse(str).data;\n\n          if (data) {\n            return data;\n          }\n        } catch {}\n      }\n\n      if ( err.detail ) {\n        if ( str ) {\n          str += ` (${ err.detail })`;\n        } else {\n          str = err.detail;\n        }\n      }\n    } else if ( err.detail ) {\n      str = err.detail;\n    } else if ( err.url ) {\n      str = `from ${ err.url }`;\n    }\n  }\n\n  if (!str) {\n    // Good luck...\n    str = JSON.stringify(err);\n  }\n\n  return str;\n}\n\nexport function exceptionToErrorsArray(err) {\n  if ( err?.response?.data ) {\n    const body = err.response.data;\n\n    if ( body && body.message ) {\n      return [body.message];\n    } else {\n      return [err];\n    }\n  } else if (err.status && err.message) {\n    return [err.message];\n  } else if ( isArray(err) ) {\n    return err;\n  } else {\n    return [err];\n  }\n}\n\n/**\n * Imported from path-to-regexp\n * @param {*} err\n * @returns\n */\nexport const normalizeError = (err) => {\n  let message;\n\n  if (!(err.message || typeof err === 'string')) {\n    try {\n      message = JSON.stringify(err, null, 2);\n    } catch (e) {\n      message = `[${ err.constructor.name }]`;\n    }\n  } else {\n    message = err.message || err;\n  }\n\n  return {\n    ...err,\n    message,\n    statusCode: (err.statusCode || err.status || (err.response && err.response.status) || 500)\n  };\n};\n","import { render } from \"./Banner.vue?vue&type=template&id=1a4e45d4&scoped=true&ts=true\"\nimport script from \"./Banner.vue?vue&type=script&lang=ts\"\nexport * from \"./Banner.vue?vue&type=script&lang=ts\"\n\nimport \"./Banner.vue?vue&type=style&index=0&id=1a4e45d4&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-1a4e45d4\"]])\n\nexport default __exports__","type UriField = 'source' | 'protocol' | 'authority' | 'userInfo' | 'user' | 'password' | 'host' | 'port' | 'relative' | 'path' | 'directory' | 'file' | 'queryStr' | 'anchor'\ntype UriFields = {\n  [key in UriField]: string; // eslint-disable-line no-unused-vars\n}\nexport type QueryParams = {\n  [key: string]: string\n}\n\ninterface ParsedUri extends UriFields {\n  query: QueryParams;\n}\n\nexport function addParam(url: string, key: string, val: string | string[]): string {\n  let out = url + (url.includes('?') ? '&' : '?');\n\n  // val can be a string or an array of strings\n  if ( !Array.isArray(val) ) {\n    val = [val];\n  }\n  out += val.map((v) => {\n    if ( v === null ) {\n      return `${ encodeURIComponent(key) }`;\n    } else {\n      return `${ encodeURIComponent(key) }=${ encodeURIComponent(v) }`;\n    }\n  }).join('&');\n\n  return out;\n}\n\nexport function addParams(url: string, params: QueryParams): string {\n  if ( params && typeof params === 'object' ) {\n    Object.keys(params).forEach((key) => {\n      url = addParam(url, key, params[key]);\n    });\n  }\n\n  return url;\n}\n\nexport function removeParam(url: string, key: string): string {\n  const parsed = parse(url);\n\n  if ( parsed.query?.[key] ) {\n    delete parsed.query[key];\n  }\n\n  return stringify(parsed);\n}\n\nexport function parseLinkHeader(str: string): Record<string, string> {\n  const out: { [key: string]: string} = { };\n  const lines = (str || '').split(',');\n\n  for ( const line of lines ) {\n    const match = line.match(/^\\s*<([^>]+)>\\s*;\\s*rel\\s*=\"(.*)\"/);\n\n    if ( match ) {\n      out[match[2].toLowerCase()] = match[1];\n    }\n  }\n\n  return out;\n}\n\nexport function isMaybeSecure(port: number, proto: string): boolean {\n  const protocol = proto.toLowerCase();\n\n  return portMatch([port], [443, 8443], ['443']) || protocol === 'https';\n}\n\nexport function portMatch(ports: number[], equals: number[], endsWith: string[]): boolean {\n  for (let i = 0; i < ports.length; i++) {\n    const port = ports[i];\n\n    if (equals.includes(port)) {\n      return true;\n    }\n\n    for (let j = 0; j < endsWith.length; j++) {\n      const suffix = `${ endsWith[j] }`;\n      const portStr = `${ port }`;\n\n      if (portStr !== suffix && portStr.endsWith(suffix)) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\n// parseUri 1.2.2\n// (c) Steven Levithan <stevenlevithan.com>\n// https://javascriptsource.com/parseuri/\n// MIT License\nexport function parse(str: string): ParsedUri {\n  const o = parse.options;\n  const m = o.parser[o.strictMode ? 'strict' : 'loose'].exec(str);\n\n  if (!m) {\n    throw new Error(`Cannot parse as uri: ${ str }`);\n  }\n  const uri = {} as ParsedUri;\n  let i = 14;\n\n  while (i--) {\n    uri[o.key[i]] = m[i] || '';\n  }\n\n  uri.query = {};\n  uri.queryStr.replace(o.q.parser, (_, $1: string, $2: string): string => {\n    if ($1) {\n      uri[o.q.name][$1] = $2;\n    }\n\n    return '';\n  });\n\n  return uri;\n}\n\nparse.options = {\n  strictMode: false,\n  key:        ['source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'queryStr', 'anchor'],\n  q:          {\n    name:   'query',\n    parser: /(?:^|&)([^&=]*)=?([^&]*)/g\n  },\n  parser: {\n    strict: /^(?:([^:\\/?#]+):)?(?:\\/\\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\\/?#]*)(?::(\\d*))?))?((((?:[^?#\\/]*\\/)*)([^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,\n    loose:  /^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/\n  }\n} as {\n  strictMode: boolean,\n  key: UriField[],\n  q: {\n    name: 'query',\n    parser: RegExp\n  },\n  parser: {\n    strict: RegExp,\n    loose: RegExp\n  }\n};\n\nexport function stringify(uri: ParsedUri): string {\n  let out = `${ uri.protocol }://`;\n\n  if ( uri.user && uri.password ) {\n    out += `${ uri.user }:${ uri.password }@`;\n  } else if ( uri.user ) {\n    out += `${ uri.user }@`;\n  }\n\n  out += uri.host;\n\n  if ( uri.port ) {\n    out += `:${ uri.port }`;\n  }\n\n  out += uri.path || '/';\n\n  out = addParams(out, uri.query || {});\n\n  if ( uri.anchor ) {\n    out += `#${ uri.anchor }`;\n  }\n\n  return out;\n}\n","import { render } from \"./pve.vue?vue&type=template&id=494ed9d5\"\nimport script from \"./pve.vue?vue&type=script&lang=js\"\nexport * from \"./pve.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".banner[data-v-1a4e45d4]{display:flex;margin:15px 0;position:relative;width:100%;color:var(--body-text)}.banner__icon[data-v-1a4e45d4]{width:48px;flex-grow:1;display:flex;justify-content:center;align-items:center;box-sizing:content-box}.primary .banner__icon[data-v-1a4e45d4]{background:var(--primary)}.secondary .banner__icon[data-v-1a4e45d4]{background:var(--default)}.success .banner__icon[data-v-1a4e45d4]{background:var(--success)}.info .banner__icon[data-v-1a4e45d4]{background:var(--info)}.warning .banner__icon[data-v-1a4e45d4]{background:var(--warning)}.error .banner__icon[data-v-1a4e45d4]{background:var(--error);color:var(--primary-text)}.banner__content[data-v-1a4e45d4]{padding:10px;transition:all .2s ease;line-height:20px;width:100%;border-left:4px solid transparent;display:flex;gap:3px}.primary .banner__content[data-v-1a4e45d4]{background:var(--primary);border-color:var(--primary)}.secondary .banner__content[data-v-1a4e45d4]{background:var(--default-banner-bg);border-color:var(--default)}.success .banner__content[data-v-1a4e45d4]{background:var(--success-banner-bg);border-color:var(--success)}.info .banner__content[data-v-1a4e45d4]{background:var(--info-banner-bg);border-color:var(--info)}.warning .banner__content[data-v-1a4e45d4]{background:var(--warning-banner-bg);border-color:var(--warning)}.error .banner__content[data-v-1a4e45d4]{background:var(--error-banner-bg);border-color:var(--error);color:var(--error)}.banner__content.stacked[data-v-1a4e45d4]{padding:0 10px;margin:0;transition:none}.banner__content.stacked[data-v-1a4e45d4]:first-child{padding-top:10px}.banner__content.stacked[data-v-1a4e45d4]:last-child{padding-bottom:10px}.banner__content.closable[data-v-1a4e45d4]{padding-right:48px}.banner__content__closer[data-v-1a4e45d4]{display:flex;align-items:center;cursor:pointer;position:absolute;top:0;right:0;bottom:0;width:24px;line-height:24px;text-align:center;outline:none}.banner__content__closer .closer-icon[data-v-1a4e45d4]{opacity:.7}.banner__content__closer .closer-icon[data-v-1a4e45d4]:hover{opacity:1;color:var(--link)}.banner__content__closer:focus-visible i[data-v-1a4e45d4]{outline:2px solid var(--primary-keyboard-focus);outline-offset:2px}.banner__content.icon[data-v-1a4e45d4]{border-left:none}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../css-loader/dist/cjs.js??clonedRuleSet-23.use[1]!../../../../vue-loader/dist/stylePostLoader.js!../../../../postcss-loader/dist/cjs.js??clonedRuleSet-23.use[2]!../../../../postcss-loader/dist/cjs.js??clonedRuleSet-23.use[3]!../../../../sass-loader/dist/cjs.js??clonedRuleSet-23.use[4]!../../../../cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../../vue-loader/dist/index.js??ruleSet[0].use[1]!./Banner.vue?vue&type=style&index=0&id=1a4e45d4&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"d4f9953a\", content, true, {\"sourceMap\":false,\"shadowMode\":false});"],"names":["class","_createElementBlock","_ctx","errorLabelKey","_hoisted_1","_createVNode","_component_Banner","color","_createElementVNode","_hoisted_2","_component_LabeledInput","type","mode","$props","value","decodedData","url","onChange","_cache","e","setData","target","$options","validate","required","_hoisted_3","_component_Checkbox","insecureTls","onClick","_createBlock","_hoisted_4","tokenId","tokenSecret","key","render","$setup","$data","_component_t","_resolveComponent","_directive_clean_html","_resolveDirective","_openBlock","_normalizeClass","role","icon","_createCommentVNode","closable","stacked","_renderSlot","$slots","labelKey","k","raw","messageLabel","_toDisplayString","_withDirectives","nlToBr","label","tabindex","t","$event","$emit","onKeyup","_withKeys","ClusterNotFoundError","Error","constructor","message","super","this","name","NAME","_defineProperty","RedirectToError","stringify","err","str","data","JSON","parse","detail","defineComponent","props","String","default","Object","Boolean","emits","computed","undefined","methods","__exports__","o","options","m","parser","strictMode","exec","uri","i","query","queryStr","replace","q","_","$1","$2","strict","loose","components","Banner","Checkbox","LabeledInput","created","test","nodeDriver","$store","dispatch","id","domain","parseUrl","host","whitelistedDomains","whitelistDomains","includes","method","headers","redirectUnauthorized","version","startsWith","_status","___CSS_LOADER_EXPORT___","push","module","content","__esModule","locals","exports","add"],"sourceRoot":""}