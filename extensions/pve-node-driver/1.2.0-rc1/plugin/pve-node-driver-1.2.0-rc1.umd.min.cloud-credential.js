(("undefined"!==typeof self?self:this)["webpackChunkpve_node_driver_1_2_0_rc1"]=("undefined"!==typeof self?self:this)["webpackChunkpve_node_driver_1_2_0_rc1"]||[]).push([[916],{1265:function(e,t,r){"use strict";r.r(t);var a=r(6758),n=r.n(a),o=r(6173),l=r.n(o),d=l()(n());d.push([e.id,".banner[data-v-09d15495]{display:flex;margin:15px 0;position:relative;width:100%;color:var(--body-text)}.banner__icon[data-v-09d15495]{width:48px;flex-grow:1;display:flex;justify-content:center;align-items:center;box-sizing:content-box}.primary .banner__icon[data-v-09d15495]{background:var(--primary)}.secondary .banner__icon[data-v-09d15495]{background:var(--default)}.success .banner__icon[data-v-09d15495]{background:var(--success)}.info .banner__icon[data-v-09d15495]{background:var(--info)}.warning .banner__icon[data-v-09d15495]{background:var(--warning)}.error .banner__icon[data-v-09d15495]{background:var(--error);color:var(--primary-text)}.banner.banner-disabled[data-v-09d15495]{filter:grayscale(1)}.banner__content[data-v-09d15495]{padding:10px;transition:all .2s ease;line-height:20px;width:100%;border-left:4px solid transparent;display:flex;gap:3px}.primary .banner__content[data-v-09d15495]{background:var(--primary);border-color:var(--primary)}.secondary .banner__content[data-v-09d15495]{background:var(--default-banner-bg);border-color:var(--default)}.success .banner__content[data-v-09d15495]{background:var(--success-banner-bg);border-color:var(--success)}.info .banner__content[data-v-09d15495]{background:var(--info-banner-bg);border-color:var(--info)}.warning .banner__content[data-v-09d15495]{background:var(--warning-banner-bg);border-color:var(--warning)}.error .banner__content[data-v-09d15495]{background:var(--error-banner-bg);border-color:var(--error);color:var(--error)}.banner__content.stacked[data-v-09d15495]{padding:0 10px;margin:0;transition:none}.banner__content.stacked[data-v-09d15495]:first-child{padding-top:10px}.banner__content.stacked[data-v-09d15495]:last-child{padding-bottom:10px}.banner__content.closable[data-v-09d15495]{padding-right:48px}.banner__content__closer[data-v-09d15495]{display:flex;align-items:center;cursor:pointer;position:absolute;top:0;right:0;bottom:0;width:24px;line-height:24px;text-align:center;outline:none}.banner__content__closer .closer-icon[data-v-09d15495]{opacity:.7}.banner__content__closer .closer-icon[data-v-09d15495]:hover{opacity:1;color:var(--link)}.banner__content__closer:focus-visible i[data-v-09d15495]{outline:2px solid var(--primary-keyboard-focus);outline-offset:2px}.banner__content.icon[data-v-09d15495]{border-left:none}",""]),t["default"]=d},3742:function(e,t,r){var a=r(1265);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);var n=r(4825).A;n("70888fc4",a,!0,{sourceMap:!1,shadowMode:!1})},9753:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return T}});var a=r(9274);const n={key:0,class:"mb-20"},o={class:"mb-20"},l={class:"mb-20"},d={class:"mb-20"};function c(e,t,r,c,i,s){const u=(0,a.resolveComponent)("Banner"),v=(0,a.resolveComponent)("LabeledInput"),b=(0,a.resolveComponent)("Checkbox");return(0,a.openBlock)(),(0,a.createElementBlock)("div",null,[e.errorLabelKey?((0,a.openBlock)(),(0,a.createElementBlock)("div",n,[(0,a.createVNode)(u,{color:"error","label-key":e.errorLabelKey},null,8,["label-key"])])):(0,a.createCommentVNode)("",!0),(0,a.createElementVNode)("div",o,[(0,a.createVNode)(v,{type:"text",mode:r.mode,value:r.value.decodedData.url,onChange:t[0]||(t[0]=e=>{r.value.setData("url",e.target.value),s.validate()}),"label-key":"cluster.credential.pve.url.label","placeholder-key":"cluster.credential.pve.url.placeholder",required:""},null,8,["mode","value"])]),(0,a.createElementVNode)("div",l,[(0,a.createVNode)(b,{mode:r.mode,value:r.value.decodedData.insecureTls,onClick:t[1]||(t[1]=e=>{r.value.setData("insecureTls",!r.value.decodedData.insecureTls),s.validate()}),"label-key":"cluster.credential.pve.insecureTLS.label"},null,8,["mode","value"]),r.value.decodedData.insecureTls?((0,a.openBlock)(),(0,a.createBlock)(u,{key:0,color:"warning","label-key":"cluster.credential.pve.insecureTLS.warning"})):(0,a.createCommentVNode)("",!0)]),(0,a.createElementVNode)("div",d,[(0,a.createVNode)(v,{type:"text",mode:r.mode,value:r.value.decodedData.tokenId,onChange:t[2]||(t[2]=e=>{r.value.setData("tokenId",e.target.value),s.validate()}),"label-key":"cluster.credential.pve.tokenID.label","placeholder-key":"cluster.credential.pve.tokenID.placeholder","tooltip-key":"cluster.credential.pve.tokenID.tooltip",required:""},null,8,["mode","value"])]),(0,a.createElementVNode)("div",null,[(0,a.createVNode)(v,{type:"password",mode:r.mode,value:r.value.decodedData.tokenSecret,onChange:t[3]||(t[3]=e=>{r.value.setData("tokenSecret",e.target.value),s.validate()}),"label-key":"cluster.credential.pve.tokenSecret.label","placeholder-key":"cluster.credential.pve.tokenSecret.placeholder",required:""},null,8,["mode","value"])])])}const i=["aria-labelledby"],s={key:0,class:"banner__icon","data-testid":"banner-icon"},u=["alt"],v=["id"],b={key:1},p={key:2},y=["aria-label"],h=["alt"];function m(e,t,r,n,o,l){const d=(0,a.resolveComponent)("t"),c=(0,a.resolveDirective)("clean-html");return(0,a.openBlock)(),(0,a.createElementBlock)("div",{class:(0,a.normalizeClass)(["banner",{[e.color]:!0,"banner-disabled":e.disabled}]),role:"region","aria-labelledby":e.labelledbyId,tabindex:"0"},[e.icon?((0,a.openBlock)(),(0,a.createElementBlock)("div",s,[(0,a.createElementVNode)("i",{class:(0,a.normalizeClass)(["icon icon-2x",e.icon]),alt:e.t("generic.banners.bannerIcon")},null,10,u)])):(0,a.createCommentVNode)("",!0),(0,a.createElementVNode)("div",{id:e.labelledbyId,class:(0,a.normalizeClass)(["banner__content",{closable:e.closable,stacked:e.stacked,icon:e.icon}]),"data-testid":"banner-content"},[(0,a.renderSlot)(e.$slots,"default",{},()=>[e.labelKey?((0,a.openBlock)(),(0,a.createBlock)(d,{key:0,k:e.labelKey,raw:!0},null,8,["k"])):e.messageLabel?((0,a.openBlock)(),(0,a.createElementBlock)("span",b,(0,a.toDisplayString)(e.messageLabel),1)):(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)("span",p,null,512)),[[c,e.nlToBr(e.label)]])],!0),e.closable?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:0,class:"banner__content__closer",tabindex:"0",role:"button","aria-label":e.t("generic.close"),onClick:t[0]||(t[0]=t=>e.$emit("close")),onKeyup:[t[1]||(t[1]=(0,a.withKeys)(t=>e.$emit("close"),["enter"])),t[2]||(t[2]=(0,a.withKeys)(t=>e.$emit("close"),["space"]))]},[(0,a.createElementVNode)("i",{"data-testid":"banner-close",class:"icon icon-close closer-icon",alt:e.t("generic.banners.altCloseBanner")},null,8,h)],40,y)):(0,a.createCommentVNode)("",!0)],10,v)],10,i)}var k=r(2043);r(8851);function f(e,t,r){return(t=_(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _(e){var t=g(e,"string");return"symbol"==typeof t?t:t+""}function g(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}class x extends Error{constructor(e){super(e),this.name=x.NAME}}f(x,"NAME","ClusterNotFoundError");class D extends Error{constructor(e,t){super(e),this.url=t,this.name=D.NAME}}f(D,"NAME","RedirectToError");Error;function w(e){let t;if("string"===typeof e)t=e;else if(e&&"object"===typeof e)if(e.message){if(t=e.message,"string"===typeof t)try{const e=JSON.parse(t).data;if(e)return e}catch{}e.detail&&(t?t+=` (${e.detail})`:t=e.detail)}else e.detail?t=e.detail:e.url&&(t=`from ${e.url}`);return t||(t=JSON.stringify(e)),t}var E=(0,a.defineComponent)({props:{color:{type:String,default:"secondary"},label:{type:[String,Error,Object],default:null},labelKey:{type:String,default:null},icon:{type:String,default:null},closable:{type:Boolean,default:!1},stacked:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["close"],data(){return{labelledbyId:`banner-labelledby-${(0,k.aR)(12)}`}},computed:{messageLabel(){return"string"!==typeof this.label?w(this.label):void 0}},methods:{nlToBr:k.Kn}}),B=(r(3742),r(7433));const C=(0,B.A)(E,[["render",m],["__scopeId","data-v-09d15495"]]);var N=C,S=r(7823),V=r(9552);function I(e){const t=I.options,r=t.parser[t.strictMode?"strict":"loose"].exec(e);if(!r)throw new Error(`Cannot parse as uri: ${e}`);const a={};let n=14;while(n--)a[t.key[n]]=r[n]||"";return a.query={},a.queryStr.replace(t.q.parser,(e,r,n)=>(r&&(a[t.q.name][r]=n),"")),a}I.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","queryStr","anchor"],q:{name:"query",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var K={components:{Banner:N,Checkbox:S.A,LabeledInput:V.o},props:{mode:{type:String,required:!0},value:{type:Object,required:!0}},data:()=>({errorLabelKey:null}),created(){this.value.setData("url",this.value.decodedData.url??""),this.value.setData("insecureTls",this.value.decodedData.insecureTls??!1),this.value.setData("tokenId",this.value.decodedData.tokenId??""),this.value.setData("tokenSecret",this.value.decodedData.tokenSecret??""),this.validate()},methods:{validate(){""!=this.value.decodedData.url&&""!=this.value.decodedData.tokenId&&""!=this.value.decodedData.tokenSecret?this.$emit("validationChanged",!0):this.$emit("validationChanged",!1)},async test(){this.errorLabelKey=null;try{const e=await this.$store.dispatch("rancher/find",{type:"nodedriver",id:"pve"}),t=I(this.value.decodedData.url).host,r=e.whitelistDomains??[];if(!r.includes(t))return this.errorLabelKey="cluster.credential.pve.errors.whitelistedDomains",!1}catch(e){return this.errorLabelKey="cluster.credential.pve.errors.fetchNodeDriver",!1}if(!this.value.decodedData.insecureTls)try{const{data:e}=await this.$store.dispatch("management/request",{method:"GET",url:"/meta/proxy/"+this.value.decodedData.url.replace(/^https?:\/\//,"")+"/api2/json/version",headers:{"X-API-Auth-Header":`PVEAPIToken=${this.value.decodedData.tokenId}=${this.value.decodedData.tokenSecret}`},redirectUnauthorized:!1});if(!e.version.startsWith("8.")&&!e.version.startsWith("9."))return this.errorLabelKey="cluster.credential.pve.errors.unsupportedProxmoxVersion",!1}catch(e){return 401==e._status?this.errorLabelKey="cluster.credential.pve.errors.fetchProxmoxVersionUnauthorized":this.errorLabelKey="cluster.credential.pve.errors.fetchProxmoxVersion",!1}return!0}}};const L=(0,B.A)(K,[["render",c]]);var T=L}}]);
//# sourceMappingURL=pve-node-driver-1.2.0-rc1.umd.min.cloud-credential.js.map